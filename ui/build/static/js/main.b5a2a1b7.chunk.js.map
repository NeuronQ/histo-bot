{"version":3,"sources":["components/ResultThumbs.module.scss","PageDashboard/PageDashboard.js","components/controls.js","components/ResultThumbs.js","PageModels/PageModels.js","PageAnalyses/PageAnalyses.js","utils.js","api/client.js","api/manager.js","api/api.js","PageTrainModel/DatasetCard.js","PageTrainModel/Step1Data.js","PageTrainModel/PaintLabelsDialog/Painter.js","PageTrainModel/Step3Training.js","PageTrainModel/PaintLabelsDialog/AddEditSegmentDialog.js","PageTrainModel/PaintLabelsDialog/SegmentMenu.js","PageTrainModel/PaintLabelsDialog/PaintLabelsDialog.js","PageTrainModel/Step2Labels.js","PageTrainModel/PageTrainModel.js","PageCreateModel/PageCreateModel.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","item","mask","img","score","ZoomDialogContainer","ZoomDialogImg","ZoomDialogThumb","PageDashboard","react_default","a","createElement","className","classNames","styles","Page","Paper_default","square","Segment","style","width","textAlign","border","boxShadow","Grid_Grid","columns","relaxed","stackable","Column","Link","to","Button_default","variant","color","verticalAlign","Divider_Divider","vertical","Component","getColor","cstr","hoverColor","_cstr$slice$split","slice","split","_cstr$slice$split2","Object","slicedToArray","colorStr","hoverColorStr","_colorStr$split","_colorStr$split2","hue","shade","mui","_hoverColorStr$split","_hoverColorStr$split2","hoverHue","hoverShade","_cstr$split","_cstr$split2","MButton","_ref","iconEl","loader","textColor","icon","iconRight","children","linkTo","loading","defaultProps","objectWithoutProperties","&:hover","indexOf","_getColor","_getColor2","col","hoverCol","colKey","_getColor3","_getColor4","textCol","textHoverCol","Icon_Icon","name","marginTop","Icon_default","concat","fontSize","marginRight","Fragment","disabled","CustomLoader","theme","root","props","CircularProgress_default","assign","classes","size","CustomButton","objectSpread","backgroundColor","palette","getContrastText","undefined","r","MPaper","mixins","gutters","paddingTop","spacing","unit","paddingBottom","SelectDialog","dialogTitle","borderBottom","divider","margin","padding","paddingRight","closeButton","position","right","top","grey","onClose","title","items","renderItem","other","Dialog_default","aria-labelledby","DialogTitle_default","id","IconButton_default","aria-label","onClick","List_default","map","ResultThumbs","state","zoomDialogOpen","zoomedImage","zoomDialogShowSegmentation","_this2","this","image","idx","key","setState","src","imgThumbSrc","alt","maskThumbSrc","fullScreen","open","AppBar_default","Toolbar_default","flexGrow","Switch_default","checked","onChange","ev","imgSrc","maskSrc","TrainBtn","DeleteBtn","createData","architecture","trained_at","trained_by","rows","Date","PageModels","newModelArchDialogOpen","handleNewModelArchDialogClose","val","_this","history","push","Table_default","TableHead_default","TableRow_default","TableCell_default","TableBody_default","row","toLocaleString","PageModels_DeleteBtn","PageModels_TrainBtn","index_es","align","PageAnalyses","asSet","x","Set","xset","classCallCheck","createClass","value","set","subset","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","elem","has","err","return","setA","setB","_union","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","add","_intersection","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","_difference","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","delete","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","xmap","xs","_Array$from","_len","arguments","length","args","Array","_key","apply","from","xomap","_Object$entries","_len2","_key2","entries","_Array$from2","getFileContents","file","reader","FileReader","Promise","resolve","reject","onload","console","log","target","result","onerror","abort","readAsBinaryString","augmentWithStateFieldArrayMethods","obj","path","suffix","data","s","imm","del","merge","base64_to_blob","str","_str$split","_str$split2","mimeType","base64Data","binData","atob","arr","i","n","charCodeAt","Blob","Uint8Array","type","baseURL","process","REACT_APP_BASE_API_URL","headers","Content-Type","REACT_APP_LOCAL_DEV_USER","REACT_APP_LOCAL_DEV_PWD","btoa","apiClient","axios","create","xsrfCookieName","xsrfHeaderName","validateStatus","status","window","location","host","pathname","_apiClient","ModelManager","keys","reduce","acc","k","match","defineProperty","res","_arr","defaultConversions","_i","_ref3","_ref2","fld","conv","out","_arr2","_i2","readOnlyFields","skipUnderscorePrefixed","defaultReadOnlyFields","created_at","updated_at","APIResponseError","_Error","response","_getPrototypeOf2","params","possibleConstructorReturn","getPrototypeOf","call","Error","captureStackTrace","assertThisInitialized","message","inherits","wrapNativeSuper","Users","_ModelManager","get","MLModels","_ModelManager2","patch","_withoutNullIds","post","Datasets","_ModelManager3","fromApiData","datasetimages","dsi","union","BaseImages","formData","FormData","append","file_contents","imageData","file_name","File","_makeFormData","endpointUrl","content-type","Images","_BaseImages","LabelImages","_BaseImages2","TrainingSessions","_ModelManager5","getWSRootUrl","REACT_APP_BASE_WS_URL","protocol","ItemBtn","RemoveBtn","DatasetCard","dataset","datasetIdx","updateTrainingDataset","removeTrainingDataset","removeTrainingDatasetImage","addTrainingDatasetImage","actions","imageActions","Card_default","CardHeader_default","avatar","Avatar_default","action","Input","subheader","dsiIdx","image_id","summary","thumb","height","datasetimage","_status","_staus","DatasetCard_RemoveBtn","marginLeft","htmlFor","w","h","ref","_fileInput","controls_MButton","React","createRef","ModelTrainingStep1Data","addDatasetDialogOpen","handleSelectDataset","addTrainingDataset","Grid_default","container","fullWidth","trainingDatasets","DatasetCard_DatasetCard","removeDataset","Step1Data_RemoveBtn","datasetsById","values","filter","ds","find","tds","it","ListItem_default","button","Painter","canvas","dx","dy","url","setDirty","getBrushMode","getBrushColor","removePixels","removeRGB","keepRGBs","g","b","rgb","isMatchedRGB","imdata","_cx","getImageData","pxs","j","nj","putImageData","getDataURL","toDataURL","_onBrushDown","isTouch","_isPaint","strokeStyle","_this$constructor$get","constructor","getBrushPos","_this$constructor$get2","bx","by","rx","scrollLeft","ry","scrollTop","beginPath","moveTo","lineTo","closePath","stroke","_lastX","_lastY","_onBrushMove","_this$constructor$get3","_this$constructor$get4","brushMode","globalCompositeOperation","_onBrushUp","getContext","_loadAndDrawImage","imageSmoothingEnabled","lineJoin","lineWidth","addEventListener","Image","crossOrigin","drawImage","event","touches","clientX","clientY","AddEditSegmentDialog","_Component","label","DialogContent_default","TextField_default","lib","colors","segmentColorsPalette","saveText","onSave","SegmentMenu","Menu_default","segmentMenuTop","left","segmentMenuLeft","MenuItem_default","menuItem","removeItem","selectedSegmentIdx","ListItemIcon_default","ListItemText_default","primary","inset","editItem","PaintLabelsDialog","imgW","imgH","imgLoaded","activeSegmentIdx","segmentCtrlsDisabled","segmentAnchorEl","addEditSegmentDialog","segmentIdx","drawerWidth","topBarHeight","handleClose","painter","label_image","_segmentation_data","removeSegment","segmentRGBs","segments","sgm","removedSegmentRGB","splice","setActiveSegment","addSegment","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","stop","_x","updateSegment","_callee2","_context2","_x2","brushColor","rgb2hex","imgRef","canvasContainerRef","existingSegmentationUrl","current","isDirty","_label_dirty","rgbArr","toString","join","_this3","Sidebar","makeSidebar","zIndex","Button_Button","Group","positive","Or","flexShrink","Drawer_default","overflow","onLoad","naturalWidth","naturalHeight","el","initDrawing","opacity","cursor","PaintLabelsDialog_AddEditSegmentDialog","_this4","toolbar","Divider_default","segment","background","minWidth","currentTarget","anchorElBox","getBoundingClientRect","Fab_default","setTimeout","PaintLabelsDialog_SegmentMenu","anchorEl","Step2Labels","paintLabelsDialog","datasetImage","DatasetCard_ItemBtn","model","PaintLabelsDialog_PaintLabelsDialog","labels","resultImages","Step3Training","epochs","trainingInProgress","trainingProgress","trainingSessionId","train","nEpochs","qs","wsPromise","ws","queryString","parse","search","ts","model_id","datasets","sent","replaceState","_ws","WebSocket","onopen","send","JSON","stringify","dataset_ids","onmessage","epoch","onclose","CardContent_default","float","LinearProgress_default","marginBottom","components_ResultThumbs","steps","description","active","PageTrainModel","DATA","Map","disableNav","replaceTrainingDatasetImage","updateTrainingDatasetImage","navToStep","stepNo","_this$props","navToNextStep","activeStepNo","activeStep","getActiveStepNo","onNextFromStep1Data","onNextFromStep2Labels","t0","finish","abrupt","createNewDatasets","_callee3","_context3","updateModel","saveLabels","markActiveStep","step","_callee4","createdDatasetImages","createImageRes","createdDatasetImage","createdDatasetRes","_context4","createImage","purpose","_error","Math","floor","_ref5","_callee5","_context5","files","update","_callee6","_context6","updateOrCreateLabelImage","label_image_id","_label_save_status","error","_label_save_error","base64ImgData","dataset_image_id","models","modelId","then","list","results","m","_this$props2","archId","arch","Typography_default","PageTrainModel_PrevBtn","PageTrainModel_NextBtn","Step","borderRadius","Switch","Route","exact","render","Step1Data_ModelTrainingStep1Data","Step2Labels_Step2Labels","Step3Training_Step3Training","NextBtn","PrevBtn","PageCreateModel","createModelThenTrain","setLastCreatedModel","App","user","lastCreatedModel","modelData","getSelf","CssBaseline_default","grow","Tabs_default","Tab_default","component","src_PageCreateModel_PageCreateModel","paper","Boolean","hostname","_","_utils_","ReactDOM","BrowserRouter","src_App_0","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.b5a2a1b7.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"item\":\"ResultThumbs_item__3gCMN\",\"mask\":\"ResultThumbs_mask__21M_S\",\"img\":\"ResultThumbs_img__1ieaa\",\"score\":\"ResultThumbs_score__33FCe\",\"ZoomDialogContainer\":\"ResultThumbs_ZoomDialogContainer__3eb2h\",\"ZoomDialogImg\":\"ResultThumbs_ZoomDialogImg__21Fkx\",\"ZoomDialogThumb\":\"ResultThumbs_ZoomDialogThumb__1nug2\"};","import React, {Component} from \"react\";\n// import PropTypes from \"prop-types\";\nimport {Link} from \"react-router-dom\";\nimport classNames from \"classnames\";\n\nimport * as mui from \"../mui-imports.js\";\nimport * as sui from \"semantic-ui-react\";\n\nimport styles from \"./PageDashboard.module.scss\";\n\nclass PageDashboard extends Component {\n  static propTypes = {};\n\n  render() {\n    return (\n      <div className={classNames(\"Page\", styles.Page)}>\n        <mui.Paper square>\n          <sui.Segment\n            style={{\n              width: \"100%\",\n              textAlign: \"center\",\n              border: 0,\n              boxShadow: \"none\",\n            }}\n          >\n            <sui.Grid columns={2} relaxed=\"very\" stackable>\n              <sui.Grid.Column>\n                <Link to=\"/models\">\n                  <mui.Button variant=\"contained\" color=\"primary\">\n                    Models\n                  </mui.Button>\n                </Link>\n              </sui.Grid.Column>\n\n              <sui.Grid.Column verticalAlign=\"middle\">\n                <Link to=\"/analyses\">\n                  <mui.Button variant=\"contained\" color=\"primary\">\n                    Analyses\n                  </mui.Button>\n                </Link>\n              </sui.Grid.Column>\n            </sui.Grid>\n\n            <sui.Divider vertical>&or;</sui.Divider>\n          </sui.Segment>\n        </mui.Paper>\n      </div>\n    );\n  }\n}\n\nexport default PageDashboard;\n","import React from \"react\";\nimport {Link} from \"react-router-dom\";\n\nimport * as mui from \"../mui-imports.js\";\nimport * as sui from \"semantic-ui-react\";\n// import {Typography} from \"@material-ui/core/styles/colorManipulator/\";\n\n/**\n *\n * @param {string} cstr\n *    eg. \":purple.500|purple.700\", \"#F0F0F0|cyan\"\n * @return {[string]} [color, hoverColor]\n */\nexport function getColor(cstr) {\n  let color, hoverColor;\n  if (cstr[0] === \":\") {\n    const [colorStr, hoverColorStr] = cstr.slice(1).split(\"|\");\n    const [hue, shade] = colorStr.split(\".\");\n    color = mui[hue][shade || 500];\n    if (hoverColorStr) {\n      let [hoverHue, hoverShade] = hoverColorStr.split(\".\");\n      hoverColor = mui[hoverHue][hoverShade];\n    } else {\n      hoverColor = mui[hue][+(shade || 500) + 200];\n    }\n  } else {\n    [color, hoverColor] = cstr.split(\"|\");\n  }\n  return [color, hoverColor];\n}\n\nexport const MButton = ({\n  color,\n  textColor,\n  icon,\n  iconRight,\n  children,\n  linkTo,\n  loading,\n  ...defaultProps\n}) => {\n  const styles = {\n    \"&:hover\": {},\n  };\n\n  if (color) {\n    if ([\"default\", \"inherit\", \"primary\", \"secondary\"].indexOf(color) !== -1) {\n      defaultProps.color = color;\n    } else {\n      let [col, hoverCol] = getColor(color);\n      const colKey =\n        defaultProps.variant === \"contained\" ? \"backgroundColor\" : \"borderColor\";\n      styles[colKey] = col;\n      if (hoverCol) {\n        styles[\"&:hover\"][colKey] = hoverCol;\n      }\n    }\n  }\n\n  if (textColor) {\n    let [textCol, textHoverCol] = getColor(textColor);\n    styles.color = textCol;\n    if (textHoverCol) {\n      styles[\"&:hover\"].color = textHoverCol;\n    }\n  }\n\n  let iconEl;\n  if (icon) {\n    if (icon.indexOf(\"sui.\") === 0) {\n      iconEl = <sui.Icon name={icon.slice(4)} style={{marginTop: \"-9px\"}} />;\n    } else {\n      if (icon.indexOf(\"fa-\") === 0) {\n        iconEl = (\n          <mui.Icon\n            className={`fas ${icon}`}\n            style={{\n              fontSize: \"1.1rem\",\n              width: \"1.5em\",\n              marginRight: 3,\n            }}\n          />\n        );\n      } else {\n        iconEl = (\n          <>\n            <mui.Icon>{icon}</mui.Icon>&nbsp;\n          </>\n        );\n      }\n    }\n  }\n\n  let loader;\n  if (loading) {\n    // loader = \"...\";\n    defaultProps.disabled = true;\n    const CustomLoader = mui.withStyles(theme => ({\n      root: {\n        // color: mui.green[500],\n        marginRight: 6,\n      },\n    }))(props => <mui.CircularProgress className={props.classes.root} {...props} />);\n    loader = <CustomLoader size={18} />;\n  }\n\n  const CustomButton = mui.withStyles(theme => ({\n    root: {\n      ...styles,\n      color:\n        styles.color ||\n        (styles.backgroundColor\n          ? theme.palette.getContrastText(styles.backgroundColor)\n          : undefined),\n    },\n  }))(props => (\n    <mui.Button\n      className={`${props.classes.root} ${props.className || \"\"}`}\n      {...{...defaultProps, ...props}}\n    />\n  ));\n\n  const r = (\n    <CustomButton>\n      {!iconRight && (loading ? loader : icon && iconEl)}\n      {/* {loading ? loader : icon && !iconRight && iconEl} */}\n      {children}\n      {/* {loading ? loader : icon && iconRight && iconEl} */}\n      {iconRight && (loading ? loader : icon && iconEl)}\n    </CustomButton>\n  );\n\n  return linkTo ? <Link to={linkTo}>{r}</Link> : r;\n};\n\nexport const MPaper = mui.withStyles(theme => ({\n  root: {\n    ...theme.mixins.gutters(),\n    paddingTop: theme.spacing.unit * 2,\n    paddingBottom: theme.spacing.unit * 2,\n  },\n}))(mui.Paper);\n\nexport const SelectDialog = mui.withStyles(theme => ({\n  dialogTitle: {\n    borderBottom: `1px solid ${theme.palette.divider}`,\n    margin: 0,\n    padding: theme.spacing.unit * 2,\n    paddingRight: 55,\n  },\n  closeButton: {\n    position: \"absolute\",\n    right: 2,\n    top: 4,\n    color: theme.palette.grey[500],\n  },\n}))(props => {\n  const {classes, onClose, title, items, renderItem, ...other} = props;\n\n  return (\n    <mui.Dialog\n      onClose={() => onClose(null)}\n      aria-labelledby=\"simple-dialog-title\"\n      className={classes.root}\n      {...other}\n    >\n      <mui.DialogTitle id=\"simple-dialog-title\" className={classes.dialogTitle}>\n        {title}\n        <mui.IconButton\n          aria-label=\"Close\"\n          className={classes.closeButton}\n          onClick={() => onClose(null)}\n        >\n          <mui.Icon>close</mui.Icon>\n        </mui.IconButton>\n      </mui.DialogTitle>\n      <mui.List>{items.map(renderItem)}</mui.List>\n    </mui.Dialog>\n  );\n});\n","import React, { Component } from \"react\";\n\nimport * as mui from \"../mui-imports.js\";\n\nimport styles from \"./ResultThumbs.module.scss\";\n\nclass ResultThumbs extends Component {\n  state = {\n    zoomDialogOpen: false,\n    zoomedImage: null,\n    zoomDialogShowSegmentation: false,\n  };\n\n  render() {\n    const { items } = this.props;\n    const { zoomedImage } = this.state;\n\n    return (\n      <>\n        <div className={styles.root}>\n          {items.map((image, idx) => (\n            <div\n              key={image.id * 100 + idx}\n              className={styles.item}\n              onClick={() =>\n                this.setState({\n                  zoomedImage: image,\n                  zoomDialogOpen: true,\n                  zoomDialogShowSegmentation: true,\n                })\n              }\n            >\n              <img\n                src={image.imgThumbSrc}\n                alt={image.id}\n                className={styles.img}\n              />\n              <img\n                src={image.maskThumbSrc}\n                alt={image.id}\n                className={styles.mask}\n              />\n              <div className={styles.score}>\n                <code>{image.score}</code>\n              </div>\n            </div>\n          ))}\n        </div>\n\n        {this.state.zoomDialogOpen && this.state.zoomedImage && (\n          <mui.Dialog\n            fullScreen\n            open={this.state.zoomDialogOpen}\n            onClose={() => this.setState({ zoomDialogOpen: false })}\n          >\n            <mui.AppBar>\n              <mui.Toolbar>\n                <div style={{ flexGrow: 1 }}>\n                  {zoomedImage.id} -{\" \"}\n                  <strong>\n                    {zoomedImage.imgThumbSrc.split(\"/\").slice(-1)[0]}\n                  </strong>\n                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Show segmentation:\n                  <mui.Switch\n                    checked={this.state.zoomDialogShowSegmentation}\n                    onChange={(ev, checked) =>\n                      this.setState({ zoomDialogShowSegmentation: checked })\n                    }\n                    aria-label=\"ShowLabels\"\n                  />\n                </div>\n                <mui.IconButton\n                  color=\"inherit\"\n                  onClick={() => this.setState({ zoomDialogOpen: false })}\n                  aria-label=\"Close\"\n                >\n                  <mui.Icon>close</mui.Icon>\n                </mui.IconButton>\n              </mui.Toolbar>\n            </mui.AppBar>\n            <div className={styles.ZoomDialogContainer}>\n              <img\n                className={styles.ZoomDialogImg}\n                src={zoomedImage.imgSrc}\n                alt=\"\"\n              />\n              {this.state.zoomDialogShowSegmentation && (\n                <img\n                  className={styles.ZoomDialogThumb}\n                  src={zoomedImage.maskSrc}\n                  alt=\"\"\n                />\n              )}\n            </div>\n          </mui.Dialog>\n        )}\n      </>\n    );\n  }\n}\n\nexport default ResultThumbs;\n","import React, {Component} from \"react\";\n// import PropTypes from \"prop-types\";\n\nimport {Link} from \"react-router-dom\";\nimport {Typography} from \"@material-ui/core\";\nimport * as mui from \"../mui-imports.js\";\n\nimport {MButton} from \"../components\";\n\nconst TrainBtn = props =>\n  MButton({\n    ...props,\n    color: \":blue\",\n    size: \"small\",\n    variant: \"contained\",\n    icon: \"fa-cogs\",\n  });\n\nconst DeleteBtn = props =>\n  MButton({\n    ...props,\n    color: \":red\",\n    textColor: \":red\",\n    size: \"small\",\n    icon: \"delete_forever\",\n  });\n\nlet id = 0;\nfunction createData(name, architecture, trained_at, trained_by) {\n  id += 1;\n  return {id, name, architecture, trained_at, trained_by};\n}\nconst rows = [\n  createData(\"Segmenter XYZ\", \"ResNet34-UNet\", new Date(), \"Diana M.\"),\n  createData(\"Nuclei segm-fg3\", \"ResNet50-UNet\", new Date(), \"Marie Q.\"),\n  createData(\"Test v10\", \"ResNet34-UNet\", new Date(), \"Pierre F.\"),\n];\n\nclass PageModels extends Component {\n  static propTypes = {};\n\n  state = {\n    newModelArchDialogOpen: false,\n  };\n\n  handleNewModelArchDialogClose = val => {\n    this.setState({newModelArchDialogOpen: false});\n    if (val) {\n      this.props.history.push(\"/models/new/step-1-data?arch=\" + val);\n    }\n  };\n\n  render() {\n    return (\n      <div className=\"Page PageModels\">\n        <mui.Paper square style={{paddingBottom: \"16px\"}}>\n          <mui.Table>\n            <mui.TableHead>\n              <mui.TableRow>\n                <mui.TableCell>Name</mui.TableCell>\n                <mui.TableCell>Architecture</mui.TableCell>\n                <mui.TableCell>Trained</mui.TableCell>\n                <mui.TableCell>By</mui.TableCell>\n                <mui.TableCell />\n              </mui.TableRow>\n            </mui.TableHead>\n            <mui.TableBody>\n              {rows.map(row => (\n                <mui.TableRow key={row.id}>\n                  <mui.TableCell>{row.name}</mui.TableCell>\n                  <mui.TableCell>{row.architecture}</mui.TableCell>\n                  <mui.TableCell>{row.trained_at.toLocaleString()}</mui.TableCell>\n                  <mui.TableCell>{row.trained_by}</mui.TableCell>\n                  <mui.TableCell>\n                    <DeleteBtn>Delete</DeleteBtn>\n                    &nbsp;&nbsp;&nbsp;\n                    <TrainBtn>Train</TrainBtn>\n                  </mui.TableCell>\n                </mui.TableRow>\n              ))}\n            </mui.TableBody>\n          </mui.Table>\n          <br />\n          <Typography align=\"center\">\n            <Link to=\"/models/new\">\n              <mui.Button\n                variant=\"contained\"\n                color=\"primary\"\n                onClick={() => this.setState({newModelArchDialogOpen: true})}\n              >\n                Create New Model\n              </mui.Button>\n            </Link>\n          </Typography>\n        </mui.Paper>\n      </div>\n    );\n  }\n}\n\nexport default PageModels;\n","import React, { Component } from \"react\";\n\n// import * as mui from \"../mui-imports.js\";\n// import * as sui from \"semantic-ui-react\";\nimport { MPaper } from \"../components\";\n\nclass PageAnalyses extends Component {\n  render() {\n    return (\n      <div className=\"Page PageAnalyses\">\n        <MPaper>\n          <code>[ list of analyses ]</code>\n        </MPaper>\n      </div>\n    );\n  }\n}\n\nexport default PageAnalyses;\n","import {default as imm} from \"object-path-immutable\";\n\nexport const asSet = x => (x instanceof Set ? x : new Set(x));\n\nexport class xset {\n  static isSuperset(set, subset) {\n    set = asSet(set);\n    subset = asSet(subset);\n    for (var elem of subset) {\n      if (!set.has(elem)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  static union(setA, setB) {\n    setA = asSet(setA);\n    setB = asSet(setB);\n    var _union = new Set(setA);\n    for (var elem of setB) {\n      _union.add(elem);\n    }\n    return _union;\n  }\n\n  static intersection(setA, setB) {\n    setA = asSet(setA);\n    setB = asSet(setB);\n    var _intersection = new Set();\n    for (var elem of setB) {\n      if (setA.has(elem)) {\n        _intersection.add(elem);\n      }\n    }\n    return _intersection;\n  }\n\n  static symmetricDifference(setA, setB) {\n    setA = asSet(setA);\n    setB = asSet(setB);\n    var _difference = new Set(setA);\n    for (var elem of setB) {\n      if (_difference.has(elem)) {\n        _difference.delete(elem);\n      } else {\n        _difference.add(elem);\n      }\n    }\n    return _difference;\n  }\n\n  static difference(setA, setB) {\n    setA = asSet(setA);\n    setB = asSet(setB);\n    var _difference = new Set(setA);\n    for (var elem of setB) {\n      _difference.delete(elem);\n    }\n    return _difference;\n  }\n}\n\n/**\n * Map over smth. that either has a .map(...), or is convertible to Array.\n *\n * Useful when you want to treat array an interators like MapIterator the same.\n */\nexport const xmap = (xs, ...args) => {\n  if (xs.map) return xs.map(...args);\n  return Array.from(xs).map(...args);\n};\n\n/**\n * Map over smth. that either has an .entries(), or is a \"POJO used as a map\".\n *\n * Useful when you want to treap POJO (plain javascript opbjects) used as maps\n * similarly with actual Map objects. Also handles the case where .entries()\n * returns a MapIterator, or smth. else convertible to Array via Array.from.\n */\nexport const xomap = (xs, ...args) => {\n  if (xs.entries) {\n    const entries = xs.entries();\n    return entries.map ? entries.map(...args) : Array.from(entries).map(...args);\n  }\n  return Object.entries(xs).map(...args);\n};\n\nexport const getFileContents = file => {\n  const reader = new FileReader();\n  return new Promise((resolve, reject) => {\n    reader.onload = ev => {\n      console.log(\"read file: ev.target.result\");\n\n      resolve(ev.target.result);\n    };\n    reader.onerror = err => {\n      reader.abort();\n      reject(err);\n    };\n    reader.readAsBinaryString(file);\n  });\n};\n\n/**\n * Augment a React Component instance with methods for manipulating state\n * fields containing arrays.\n *\n * Intended to be called at the end of the constructor.\n *\n * Adds:\n * - add{MyField}(data)\n * - remove{MyField}(idx)\n * - replace{MyField}(idx)\n * - update{MyField}(idx)\n *\n * By default {MyField} is fieldName singular (only basic \"s\" plurals are\n * undrestood by it) and capitalized, but to change it just provide\n * an `Array [fieldName, \"NicerName\"]` instead of `fieldName`.\n */\nexport const augmentWithStateFieldArrayMethods = (obj, path, suffix) => {\n  obj[\"add\" + suffix] = data => obj.setState(s => imm.push(s, path, data));\n\n  obj[\"remove\" + suffix] = idx => obj.setState(s => imm.del(s, `${path}.${idx}`));\n\n  obj[\"replace\" + suffix] = (idx, data) =>\n    obj.setState(s => imm.set(s, `${path}.${idx}`, data));\n\n  obj[\"update\" + suffix] = (idx, data) =>\n    obj.setState(s => imm.merge(s, `${path}.${idx}`, data));\n};\n\nexport const base64_to_blob = str => {\n  const [_data, mimeType, _base64, base64Data] = str.split(/[:;,]/, 4); // eslint-disable-line\n  const binData = atob(base64Data);\n  const arr = [];\n  for (let i = 0, n = binData.length; i < n; i++) {\n    arr.push(binData.charCodeAt(i));\n  }\n  return new Blob([new Uint8Array(arr)], {type: mimeType});\n};\n","import axios from \"axios\";\n\nexport const baseURL = process.env.REACT_APP_BASE_API_URL || \"/api/v1\";\n\nconst headers = {\n  \"Content-Type\": \"application/json\",\n};\nif (process.env.REACT_APP_LOCAL_DEV_USER && process.env.REACT_APP_LOCAL_DEV_PWD) {\n  headers[\"Authorization\"] = `Basic ${btoa(\n    process.env.REACT_APP_LOCAL_DEV_USER + \":\" + process.env.REACT_APP_LOCAL_DEV_PWD\n  )}`;\n}\n\nexport const apiClient = axios.create({\n  baseURL,\n  headers,\n  xsrfCookieName: \"csrftoken\",\n  xsrfHeaderName: \"X-CSRFToken\",\n  validateStatus: status => {\n    const unauthorizedStatus = 401;\n    const forbiddenStatus = 403;\n    if (\n      (status === unauthorizedStatus || status === forbiddenStatus) &&\n      window.location.host.indexOf(\":\") === -1\n    ) {\n      window.location.pathname = \"/accounts/login/\";\n    }\n    return status >= 200 && status < 400;\n  },\n});\n\nwindow._apiClient = apiClient; // DEBUG\n","export default class ModelManager {\n  static defaultReadOnlyFields = new Set([\"created_at\", \"updated_at\"]);\n  static defaultConversions = {\n    created_at: s => new Date(s),\n    updated_at: s => new Date(s),\n  };\n  static skipUnderscorePrefixed = true;\n\n  static _withoutNullIds(data) {\n    return Object.keys(data).reduce(\n      (acc, k) => (k.match(/_id$/) && data[k] === null ? acc : {...acc, [k]: data[k]}),\n      {}\n    );\n  }\n\n  static fromApiData(data) {\n    const res = {...data};\n    for (const [fld, conv] of Object.entries(this.defaultConversions)) {\n      res[fld] = conv(res[fld]);\n    }\n    return res;\n  }\n\n  static toApiData(obj) {\n    const out = {};\n    for (let k of Object.keys(obj)) {\n      if (this.readOnlyFields.has(k)) continue;\n      if (this.skipUnderscorePrefixed && k[0] === \"_\") continue;\n      out[k] = obj[k];\n    }\n    return out;\n  }\n\n  static;\n}\n","import {apiClient} from \"./client.js\";\nimport ModelManager from \"./manager.js\";\nimport {xset, base64_to_blob} from \"../utils.js\";\n\nexport class APIResponseError extends Error {\n  constructor(response, ...params) {\n    super(...params);\n    if (Error.captureStackTrace) Error.captureStackTrace(this, APIResponseError);\n    this.message = `API error (HTTP code ${response.status}): ${this.message}`;\n    this.response = response;\n  }\n}\n\nexport class Users extends ModelManager {\n  static readOnlyFields = new Set([\"email\"]);\n\n  static getSelf() {\n    return apiClient.get(\"/self/\");\n  }\n}\n\nexport class MLModels extends ModelManager {\n  static get(id) {\n    return apiClient.get(`/models/${id}/`);\n  }\n\n  static update(data) {\n    return apiClient.patch(`/models/${data.id}/`, this._withoutNullIds(data));\n  }\n\n  static create(data) {\n    return apiClient.post(\"/models/\", data);\n  }\n}\n\nexport class Datasets extends ModelManager {\n  static readOnlyFields = xset.union(ModelManager.readOnlyFields, [\"datasetimages\"]);\n\n  static fromApiData(data) {\n    const res = ModelManager.fromApiData(data);\n    res.datasetimages = res.datasetimages.map(dsi => ModelManager.fromApiData(dsi));\n    return res;\n  }\n\n  static list() {\n    return apiClient.get(\"/datasets/\");\n  }\n\n  static create(data) {\n    return apiClient.post(\"/datasets/\", data);\n  }\n}\n\nclass BaseImages extends ModelManager {\n  static _makeFormData(data) {\n    const formData = new FormData();\n    for (let [fld, val] of Object.entries(data)) {\n      if (fld === \"image\") continue;\n      formData.append(fld, val);\n    }\n\n    if (data.image.file_contents) {\n      let imageData = data.image.file_contents;\n      if (typeof imageData === \"string\" && imageData.slice(0, 5) === \"data:\") {\n        imageData = base64_to_blob(imageData);\n      }\n      formData.append(\"image\", imageData, data.image.file_name || \"_.png\");\n    } else if (data.image.file instanceof File) {\n      formData.append(\n        \"image\",\n        data.image.file,\n        data.image.file_name || data.image.file.name\n      );\n    }\n    return formData;\n  }\n\n  static create(data) {\n    const formData = this._makeFormData(data);\n    return apiClient.post(this.endpointUrl, formData, {\n      headers: {\n        \"content-type\": \"multipart/form-data\",\n      },\n    });\n  }\n\n  static update(data) {\n    const formData = this._makeFormData(data);\n    return apiClient.patch(`${this.endpointUrl}${data.id}/`, formData, {\n      headers: {\n        \"content-type\": \"multipart/form-data\",\n      },\n    });\n  }\n}\n\nexport class Images extends BaseImages {\n  static endpointUrl = \"/images/\";\n}\n\nexport class LabelImages extends BaseImages {\n  static endpointUrl = \"/label-images/\";\n}\n\nexport class TrainingSessions extends ModelManager {\n  static get(id) {\n    return apiClient.get(`/training-sessions/${id}/`);\n  }\n\n  static create(data) {\n    return apiClient.post(`/training-sessions/`, this._withoutNullIds(data));\n  }\n}\n\nexport const getWSRootUrl = () => {\n  if (process.env.REACT_APP_BASE_WS_URL) return process.env.REACT_APP_BASE_WS_URL;\n  return (\n    (window.location.protocol === \"https:\" ? \"wss:\" : \"ws:\") +\n    \"//\" +\n    window.location.host +\n    \"/ws\"\n  );\n};\n","import React from \"react\";\nimport * as sui from \"semantic-ui-react\";\n\nimport * as mui from \"../mui-imports.js\";\nimport {MButton} from \"../components\";\n\nexport const ItemBtn = props =>\n  MButton({\n    size: \"small\",\n    style: {marginTop: -8, marginRight: 8},\n    ...props,\n  });\n\nconst RemoveBtn = props =>\n  ItemBtn({\n    icon: \"fa-times\",\n    children: \"Remove\",\n    ...props,\n  });\n\nexport const DatasetCard = ({\n  dataset,\n  datasetIdx,\n  removeTrainingDataset,\n  updateTrainingDataset,\n  removeTrainingDatasetImage,\n  addTrainingDatasetImage,\n  actions,\n  imageActions,\n}) => (\n  <div>\n    <mui.Card square>\n      <mui.CardHeader\n        avatar={\n          <mui.Avatar aria-label=\"Recipe\" style={{backgroundColor: mui.teal[500]}}>\n            <mui.Icon\n              className=\"fas fa-database\"\n              style={{\n                textAlign: \"center\",\n                fontSize: \"1.2rem\",\n              }}\n            />\n          </mui.Avatar>\n        }\n        action={\n          <>\n            <br />\n            {actions}\n          </>\n        }\n        title={\n          <>\n            Dataset:{\" \"}\n            {dataset.id ? (\n              <code>\n                {dataset.created_at.toLocaleString()} - {dataset.name}\n              </code>\n            ) : (\n              <sui.Input\n                value={dataset.name}\n                onChange={ev => updateTrainingDataset({name: ev.target.value})}\n                style={{width: 400}}\n              />\n            )}\n          </>\n        }\n        subheader={`${dataset.datasetimages.length} images`}\n      />\n    </mui.Card>\n    <div>\n      {dataset.datasetimages.map((dsi, dsiIdx) => (\n        <mui.Card key={`${dataset.id}-${datasetIdx}-${dsi.id}-${dsiIdx}`} square>\n          <mui.CardHeader\n            avatar={\n              <mui.Avatar style={{backgroundColor: mui.purple[500]}}>\n                {dsi.image_id ? (\n                  <img\n                    src={dsi.image.summary.thumb}\n                    style={{width: \"100%\", height: \"auto\"}}\n                    alt=\"\"\n                  />\n                ) : (\n                  <mui.Icon>image</mui.Icon>\n                )}\n              </mui.Avatar>\n            }\n            action={\n              <>\n                <br />\n                {imageActions && (\n                  <div>\n                    <span style={{position: \"relative\", top: -4, marginRight: 8}}>\n                      {imageActions({datasetimage: dsi})}\n                    </span>\n                  </div>\n                )}\n\n                {(dsi._status === \"not uploaded\" || dsi._staus === \"uploaded\") && (\n                  <RemoveBtn onClick={() => removeTrainingDatasetImage(dsiIdx)} />\n                )}\n\n                {dsi._status === \"uploading\" && (\n                  <div>\n                    <span style={{position: \"relative\", top: -4, marginRight: 16}}>\n                      Uploading...\n                      <mui.CircularProgress\n                        style={{\n                          width: 20,\n                          height: 20,\n                          marginLeft: 16,\n                          position: \"relative\",\n                          top: 4,\n                        }}\n                      />\n                    </span>\n                  </div>\n                )}\n\n                {dsi._status === \"upload failed\" && (\n                  <div>\n                    <span\n                      style={{\n                        position: \"relative\",\n                        top: -4,\n                        marginRight: 8,\n                        color: \"red\",\n                      }}\n                    >\n                      Upload failed!\n                    </span>\n                    <RemoveBtn\n                      onClick={() => removeTrainingDatasetImage(dsiIdx)}\n                      variant=\"outlined\"\n                    />\n                  </div>\n                )}\n              </>\n            }\n            title={\n              dsi.image_id ? (\n                dsi.image.name\n              ) : (\n                <label\n                  htmlFor={`input-dsi-image-${dataset.id}-${datasetIdx}-${\n                    dsi.id\n                  }-${dsiIdx}`}\n                >\n                  Choose image to upload:\n                </label>\n              )\n            }\n            subheader={\n              dsi.image_id ? (\n                `${dsi.image.w}×${dsi.image.h} px`\n              ) : (\n                <input\n                  type=\"file\"\n                  id={`input-dsi-image-${dataset.id}-${datasetIdx}-${dsi.id}-${dsiIdx}`}\n                  ref={dsi._fileInput}\n                />\n              )\n            }\n          />\n        </mui.Card>\n      ))}\n\n      {!dataset.id && (\n        <mui.Card square>\n          <mui.CardHeader\n            title={\n              <MButton\n                onClick={() =>\n                  addTrainingDatasetImage({\n                    _fileInput: React.createRef(),\n                    _status: \"not uploaded\",\n                  })\n                }\n                variant=\"contained\"\n                color=\":purple\"\n              >\n                Add Image\n              </MButton>\n            }\n          />\n        </mui.Card>\n      )}\n\n      <br />\n    </div>\n  </div>\n);\n","import React, {Component} from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport * as mui from \"../mui-imports.js\";\nimport {MButton, SelectDialog} from \"../components\";\nimport {DatasetCard} from \"./DatasetCard.js\";\n\nconst ItemBtn = props =>\n  MButton({\n    size: \"small\",\n    style: {marginTop: -8, marginRight: 8},\n    ...props,\n  });\n\nconst RemoveBtn = props =>\n  ItemBtn({\n    icon: \"fa-times\",\n    children: \"Remove\",\n    ...props,\n  });\n\nexport default class ModelTrainingStep1Data extends Component {\n  static propTypes = {\n    model: PropTypes.object,\n    datasetsById: PropTypes.instanceOf(Map).isRequired,\n    trainingDatasets: PropTypes.arrayOf(Object).isRequired,\n    addTrainingDataset: PropTypes.func.isRequired,\n    removeTrainingDataset: PropTypes.func.isRequired,\n    updateTrainingDataset: PropTypes.func.isRequired,\n    addTrainingDatasetImage: PropTypes.func.isRequired,\n    removeTrainingDatasetImage: PropTypes.func.isRequired,\n  };\n\n  state = {\n    addDatasetDialogOpen: false,\n  };\n\n  handleSelectDataset = dataset => {\n    this.setState({addDatasetDialogOpen: false});\n    if (dataset) {\n      this.props.addTrainingDataset(dataset);\n    }\n  };\n\n  render() {\n    return (\n      <>\n        <mui.Grid container spacing={16}>\n          <mui.Grid item xs={6}>\n            <MButton\n              children=\"Select Dataset\"\n              onClick={() => this.setState({addDatasetDialogOpen: true})}\n              color=\":teal\"\n              variant=\"contained\"\n              icon=\"fa-database\"\n              fullWidth\n            />\n          </mui.Grid>\n          <mui.Grid item xs={6}>\n            <MButton\n              children=\"New Dataset / Upload Image(s)\"\n              onClick={() =>\n                this.props.addTrainingDataset({\n                  name: \"\",\n                  datasetimages: [\n                    {\n                      _fileInput: React.createRef(),\n                      _status: \"not uploaded\",\n                    },\n                  ],\n                })\n              }\n              color=\":purple\"\n              variant=\"contained\"\n              icon=\"cloud_upload\"\n              fullWidth\n            />\n          </mui.Grid>\n        </mui.Grid>\n        <br />\n\n        {this.props.trainingDatasets.map((dataset, datasetIdx) => (\n          <DatasetCard\n            key={`${dataset.id}-${datasetIdx}`}\n            dataset={dataset}\n            datasetIdx={datasetIdx}\n            removeDataset={() => this.props.removeTrainingDataset(datasetIdx)}\n            updateTrainingDataset={data =>\n              this.props.updateTrainingDataset(datasetIdx, data)\n            }\n            removeTrainingDatasetImage={dsiIdx =>\n              this.props.removeTrainingDatasetImage(datasetIdx, dsiIdx)\n            }\n            addTrainingDatasetImage={data =>\n              this.props.addTrainingDatasetImage(datasetIdx, data)\n            }\n            actions={\n              <RemoveBtn\n                onClick={() => this.props.removeTrainingDataset(datasetIdx)}\n                variant=\"outlined\"\n              />\n            }\n          />\n        ))}\n\n        <SelectDialog\n          title=\"Add dataset\"\n          open={this.state.addDatasetDialogOpen}\n          onClose={() => this.handleSelectDataset(null)}\n          items={Array.from(this.props.datasetsById.values()).filter(\n            ds => !this.props.trainingDatasets.find(tds => tds.id === ds.id)\n          )}\n          renderItem={it => (\n            <mui.ListItem\n              button\n              onClick={() => this.handleSelectDataset(this.props.datasetsById.get(it.id))}\n              key={it.id}\n            >\n              {it.name}\n            </mui.ListItem>\n          )}\n        />\n      </>\n    );\n  }\n}\n","export default class Painter {\n  constructor({canvas, container, dx, dy, url, setDirty, getBrushMode, getBrushColor}) {\n    this.canvas = canvas;\n    this.container = container;\n    this.dx = dx;\n    this.dy = dy;\n    this.setDirty = setDirty;\n    this.getBrushMode = getBrushMode;\n    this.getBrushColor = getBrushColor;\n\n    this._cx = this.canvas.getContext(\"2d\");\n    this._isPaint = false;\n    this._lastX = null;\n    this._lastY = null;\n\n    if (url) this._loadAndDrawImage(url);\n\n    this._cx.imageSmoothingEnabled = false;\n    this._cx.lineJoin = \"round\";\n    this._cx.lineWidth = 4;\n    this._cx.globalCompositeOperation = \"source-over\";\n\n    this.canvas.addEventListener(\"mousedown\", ev => this._onBrushDown(ev), false);\n    this.canvas.addEventListener(\"touchstart\", ev => this._onBrushDown(ev, true), false);\n\n    this.canvas.addEventListener(\"mousemove\", ev => this._onBrushMove(ev), false);\n    this.canvas.addEventListener(\"touchmove\", ev => this._onBrushMove(ev, true), false);\n\n    this.canvas.addEventListener(\"mouseup\", this._onBrushUp, false);\n    this.canvas.addEventListener(\"touchend\", this._onBrushUp, false);\n  }\n\n  removePixels = (removeRGB, keepRGBs) => {\n    const imdata = this._cx.getImageData(0, 0, this.canvas.width, this.canvas.height);\n    const pxs = imdata.data;\n\n    let r, g, b, a, rgb, isMatchedRGB;\n    for (let i = 0, n = pxs.length; i < n; i += 4) {\n      [r, g, b, a] = [pxs[i], pxs[i + 1], pxs[i + 2], pxs[i + 3]];\n\n      // clean up semitransparent pixels\n      if (a !== 255) {\n        pxs[i] = pxs[i + 1] = pxs[i + 2] = pxs[i + 3] = 0;\n        continue;\n      }\n\n      // clean up removed segment pixels\n      if (r === removeRGB[0] && g === removeRGB[1] && b === removeRGB[2]) {\n        pxs[i] = pxs[i + 1] = pxs[i + 2] = pxs[i + 3] = 0;\n        continue;\n      }\n\n      // clean up pixels that match no known segments\n      isMatchedRGB = false;\n      for (let j = 0, nj = keepRGBs.length; j < nj; j++) {\n        rgb = keepRGBs[j];\n        if (rgb[0] === r && rgb[1] === g && rgb[2] === b) {\n          isMatchedRGB = true;\n        }\n      }\n      if (!isMatchedRGB) {\n        pxs[i] = pxs[i + 1] = pxs[i + 2] = pxs[i + 3] = 0;\n      }\n    }\n    this._cx.putImageData(imdata, 0, 0);\n\n    this.setDirty(true);\n  };\n\n  getDataURL = () => this.canvas.toDataURL();\n\n  _loadAndDrawImage(url) {\n    const img = new Image();\n    img.crossOrigin = \"anonymous\";\n    img.onload = () => {\n      this._cx.drawImage(img, 0, 0);\n    };\n    img.src = url;\n  }\n\n  _onBrushDown = (ev, isTouch) => {\n    this.setDirty(true);\n    this._isPaint = true;\n\n    this._cx.strokeStyle = this.getBrushColor();\n\n    const [bx, by] = this.constructor.getBrushPos(ev, isTouch);\n\n    const rx = bx + this.container.scrollLeft + this.dx;\n    const ry = by + this.container.scrollTop + this.dy;\n\n    this._cx.beginPath();\n    this._cx.moveTo(rx, ry);\n    this._cx.lineTo(rx + 1, ry + 1);\n    this._cx.closePath();\n    this._cx.stroke();\n\n    this._lastX = rx;\n    this._lastY = ry + 1;\n  };\n\n  _onBrushMove = (ev, isTouch) => {\n    if (!this._isPaint) return;\n\n    const [bx, by] = this.constructor.getBrushPos(ev, isTouch);\n\n    const brushMode = this.getBrushMode();\n    if (brushMode === \"draw\") {\n      this._cx.globalCompositeOperation = \"source-over\";\n    } else if (brushMode === \"erase\") {\n      this._cx.globalCompositeOperation = \"destination-out\";\n    }\n\n    const rx = bx + this.container.scrollLeft + this.dx;\n    const ry = by + this.container.scrollTop + this.dy;\n\n    this._cx.beginPath();\n    this._cx.moveTo(this._lastX, this._lastY);\n    this._cx.lineTo(rx, ry);\n    this._cx.closePath();\n    this._cx.stroke();\n\n    this._lastX = rx;\n    this._lastY = ry;\n  };\n\n  _onBrushUp = () => (this._isPaint = false);\n\n  static getBrushPos = (event, isTouch) => {\n    if (!isTouch) {\n      return [event.clientX, event.clientY];\n    } else {\n      return [event.touches[0].clientX, event.touches[0].clientY];\n    }\n  };\n}\n","import React, {Component} from \"react\";\nimport PropTypes from \"prop-types\";\nimport queryString from \"query-string\";\nimport * as sui from \"semantic-ui-react\";\n\nimport * as mui from \"../mui-imports.js\";\nimport {MButton, ResultThumbs} from \"../components\";\nimport {TrainingSessions, getWSRootUrl} from \"../api/api.js\";\n\nconst resultImages = [\n  {\n    id: 0,\n    imgThumbSrc: \"/IHC S100 18EH20842__00.png\",\n    maskThumbSrc: \"/IHC S100 18EH20842__00_S.png\",\n    imgSrc: \"/IHC S100 18EH20842.png\",\n    maskSrc: \"/IHC S100 18EH20842_S.png\",\n    score: \"91.20%\",\n  },\n  {\n    id: 1,\n    imgThumbSrc: \"/IHC S100 18EH20842__00.png\",\n    maskThumbSrc: \"/IHC S100 18EH20842__00_S.png\",\n    imgSrc: \"/IHC S100 18EH20842.png\",\n    maskSrc: \"/IHC S100 18EH20842_S.png\",\n    score: \"23.10%\",\n  },\n];\nfor (let i = 0; i < 2; i++) resultImages.push(...resultImages);\n\nexport default class Step3Training extends Component {\n  static propTypes = {\n    model: PropTypes.object,\n    trainingDatasets: PropTypes.arrayOf(Object).isRequired,\n  };\n\n  state = {\n    epochs: 10,\n    trainingInProgress: false,\n    trainingProgress: 0,\n  };\n\n  // trainingSessionId = null;\n  trainingSessionId = 1;\n\n  componentWillUnmount() {}\n\n  simulateTraining() {\n    this.setState({\n      trainingInProgress: true,\n      trainingProgress: 0,\n    });\n    setTimeout(() => {\n      this.setState({\n        trainingInProgress: true,\n        trainingProgress: 60,\n      });\n      setTimeout(\n        () =>\n          this.setState({\n            trainingInProgress: false,\n            trainingProgress: 100,\n          }),\n        3000\n      );\n    }, 1000);\n  }\n\n  train = async () => {\n    const nEpochs = 10; // DEBUG\n\n    this.setState({\n      trainingInProgress: true,\n      trainingProgress: 0,\n    });\n\n    // - check if training session is created\n    // - create if not\n    if (!this.trainingSessionId) {\n      const qs = queryString.parse(this.props.location.search);\n      if (qs.ts) {\n        this.trainingSessionId = +qs.ts;\n      } else {\n        const res = await TrainingSessions.create({\n          model_id: this.props.model.id,\n          datasets: this.props.trainingDatasets.map(ds => ds.id),\n        });\n        this.trainingSessionId = res.data.id;\n        window.history.replaceState({}, \"\", \"?ts=\" + this.trainingSessionId);\n      }\n    }\n    // - connect to websocket route with session id\n    const wsPromise = new Promise((resolve, reject) => {\n      console.log(\"~ websocket connecting\");\n      this._ws = new WebSocket(\n        getWSRootUrl() +\n          `/train/model-${this.props.model.id}/ts-${this.trainingSessionId}/`\n      );\n      console.log(\"~ websocket created\", this._ws);\n      this._ws.onerror = ev => {\n        console.log(\"~ ws error\", ev);\n        reject(ev);\n      };\n      this._ws.onopen = ev => {\n        console.log(\"~ ws open\");\n        resolve(this._ws, ev);\n      };\n    });\n    const ws = await wsPromise;\n    console.log(\"~ websocket connected\", ws);\n    // - send ws train command\n    ws.send(\n      JSON.stringify({\n        type: \"train\",\n        // __fake__: true,\n        dataset_ids: [2],\n        params: {epochs: 10},\n      })\n    );\n    // - listen until progress 100% or error\n    ws.onmessage = ev => {\n      const data = JSON.parse(ev.data);\n      console.log(\"=== received websocket message:\", data);\n      if (data.type === \"training_progress\") {\n        this.setState({\n          trainingInProgress: data.epoch === nEpochs ? false : true,\n          trainingProgress: (data.epoch / nEpochs) * 100,\n        });\n      }\n    };\n    // - close websocket\n    ws.onclose = ev => {\n      this.setState({trainingInProgress: false});\n      console.log(\"~ websocket closed\", ev);\n    };\n  };\n\n  render() {\n    return (\n      <>\n        <mui.Card square>\n          <mui.CardContent>\n            <div>\n              <label>\n                Epochs: &nbsp;&nbsp;\n                <sui.Input\n                  value={this.state.epochs}\n                  type=\"number\"\n                  onChange={ev => this.setState({epochs: +ev.target.value})}\n                  style={{width: 80}}\n                />\n              </label>\n\n              <MButton\n                children=\"Train\"\n                color=\":blue\"\n                variant=\"contained\"\n                icon=\"fa-cogs\"\n                style={{float: \"right\", width: 124}}\n                loading={this.state.trainingInProgress}\n                onClick={this.train}\n              />\n            </div>\n            {this.state.trainingInProgress && (\n              <mui.LinearProgress\n                variant=\"determinate\"\n                value={this.state.trainingProgress}\n                style={{marginTop: 16}}\n              />\n            )}\n          </mui.CardContent>\n        </mui.Card>\n\n        <br />\n        <mui.Card square style={{border: `1px solid ${mui.blue[500]}`}}>\n          <mui.CardContent>\n            <div>\n              <div style={{float: \"right\"}}>\n                <MButton\n                  children=\"Save\"\n                  color=\":green\"\n                  textColor=\"#fff\"\n                  variant=\"contained\"\n                  icon=\"save_alt\"\n                  style={{width: 100, marginBottom: 16}}\n                />\n                <br />\n                <MButton\n                  children=\"Discard\"\n                  textColor=\":red\"\n                  icon=\"delete_outline\"\n                  style={{width: 100}}\n                />\n              </div>\n              <p>\n                <code>2019-02-03 18:42</code>\n              </p>\n              <p>\n                <strong>10 Epochs</strong>\n                <br />\n                Results - accurracy:{\" \"}\n                <strong>\n                  <code>83.12%</code>\n                </strong>\n              </p>\n              <br />\n              <br />\n              <div\n                style={{\n                  padding: 16,\n                  background: \"#f4f0fa\",\n                }}\n              >\n                <ResultThumbs items={resultImages} />\n              </div>\n            </div>\n          </mui.CardContent>\n        </mui.Card>\n      </>\n    );\n  }\n}\n","import React, {Component} from \"react\";\nimport PropTypes from \"prop-types\";\nimport {CompactPicker} from \"react-color\";\n\nimport * as mui from \"../../mui-imports.js\";\nimport {MButton} from \"../../components/index.js\";\n\nconst AddEditSegmentDialog = mui.withStyles(theme => ({\n  dialogTitle: {\n    borderBottom: `1px solid ${theme.palette.divider}`,\n    margin: 0,\n    padding: theme.spacing.unit * 2,\n    paddingRight: 55,\n  },\n  closeButton: {\n    position: \"absolute\",\n    right: 2,\n    top: 4,\n    color: theme.palette.grey[500],\n  },\n}))(\n  class AddEditSegmentDialog extends Component {\n    state = {\n      label: this.props.label,\n      rgb: this.props.rgb,\n    };\n\n    render() {\n      const props = this.props;\n\n      return (\n        <mui.Dialog open={props.open} onClose={props.onClose}>\n          <mui.DialogTitle id=\"add-segment-dialog\" className={props.classes.dialogTitle}>\n            {this.props.dialogTitle}\n            <mui.IconButton\n              aria-label=\"Close\"\n              className={props.classes.closeButton}\n              onClick={props.onClose}\n            >\n              <mui.Icon>close</mui.Icon>\n            </mui.IconButton>\n          </mui.DialogTitle>\n          <mui.DialogContent>\n            <mui.TextField\n              id=\"standard-name\"\n              label=\"Name\"\n              value={this.state.label}\n              onChange={ev => this.setState({label: ev.target.value})}\n              margin=\"normal\"\n            />\n            <br />\n            <br />\n            Color:\n            <br />\n            <CompactPicker\n              color={{\n                r: this.state.rgb[0],\n                g: this.state.rgb[1],\n                b: this.state.rgb[2],\n              }}\n              onChange={color => {\n                this.setState({\n                  rgb: [color.rgb.r, color.rgb.g, color.rgb.b],\n                });\n              }}\n              colors={segmentColorsPalette}\n            />\n            <br />\n            <br />\n            <br />\n            <MButton\n              icon=\"add\"\n              children={props.saveText}\n              color=\":pink\"\n              variant=\"contained\"\n              fullWidth\n              onClick={() => this.props.onSave(this.state)}\n            />\n          </mui.DialogContent>\n        </mui.Dialog>\n      );\n    }\n  }\n);\n\nAddEditSegmentDialog.propTypes = {\n  open: PropTypes.bool.isRequired,\n  saveText: PropTypes.string.isRequired,\n  label: PropTypes.string.isRequired,\n  rgb: PropTypes.array.isRequired,\n  segmentIdx: PropTypes.number,\n  onSave: PropTypes.func,\n};\n\nexport default AddEditSegmentDialog;\n\nconst segmentColorsPalette = [\n  \"#FF0000\",\n  \"#00FF00\",\n  \"#0000FF\",\n  \"#F44E3B\",\n  \"#FE9200\",\n  \"#FCDC00\",\n  \"#DBDF00\",\n  \"#A4DD00\",\n  \"#68CCCA\",\n  \"#73D8FF\",\n  \"#AEA1FF\",\n  \"#FDA1FF\",\n  \"#008800\",\n  \"cyan\",\n  \"magenta\",\n  \"#D33115\",\n  \"#E27300\",\n  \"#FCC400\",\n  \"#B0BC00\",\n  \"#68BC00\",\n  \"#16A5A5\",\n  \"#009CE0\",\n  \"#7B64FF\",\n  \"#FA28FF\",\n  \"yellow\",\n  \"#000000\",\n  \"#FFFFFF\",\n  \"#9F0500\",\n  \"#C45100\",\n  \"#FB9E00\",\n  \"#808900\",\n  \"#194D33\",\n  \"#0C797D\",\n  \"#0062B1\",\n  \"#653294\",\n  \"#AB149E\",\n];\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {default as imm} from \"object-path-immutable\";\n\nimport * as mui from \"../../mui-imports.js\";\n\nconst SegmentMenu = mui.withStyles({})(props => {\n  return (\n    <mui.Menu\n      id=\"segment-menu\"\n      style={{\n        top: props.segmentMenuTop,\n        left: props.segmentMenuLeft,\n      }}\n      {...imm(props)\n        .del(\"removeItem\")\n        .del(\"editItem\")\n        .del(\"selectedSegmentIdx\")\n        .del(\"segmentMenuTop\")\n        .del(\"segmentMenuLeft\")\n        .value()}\n    >\n      <mui.MenuItem\n        className={props.classes.menuItem}\n        onClick={() => {\n          props.removeItem(props.selectedSegmentIdx);\n          props.onClose();\n        }}\n      >\n        <mui.ListItemIcon className={props.classes.icon}>\n          <mui.Icon>close</mui.Icon>\n        </mui.ListItemIcon>\n        <mui.ListItemText\n          classes={{primary: props.classes.primary}}\n          inset\n          primary=\"Remove Segment\"\n        />\n      </mui.MenuItem>\n      <mui.MenuItem\n        className={props.classes.menuItem}\n        onClick={() => {\n          props.editItem(props.selectedSegmentIdx);\n          props.onClose();\n        }}\n      >\n        <mui.ListItemIcon className={props.classes.icon}>\n          <mui.Icon>edit</mui.Icon>\n        </mui.ListItemIcon>\n        <mui.ListItemText\n          classes={{primary: props.classes.primary}}\n          inset\n          primary=\"Edit segment\"\n        />\n      </mui.MenuItem>\n    </mui.Menu>\n  );\n});\n\nSegmentMenu.propTypes = {\n  anchorEl: PropTypes.object,\n  open: PropTypes.bool.isRequired,\n  onClose: PropTypes.func.isRequired,\n  removeItem: PropTypes.func.isRequired,\n  editItem: PropTypes.func.isRequired,\n  selectedSegmentIdx: PropTypes.number,\n  segmentMenuTop: PropTypes.number,\n  segmentMenuLeft: PropTypes.number,\n};\n\nexport default SegmentMenu;\n","import React, {Component} from \"react\";\nimport PropTypes from \"prop-types\";\nimport {default as imm} from \"object-path-immutable\";\nimport * as sui from \"semantic-ui-react\";\n\nimport * as mui from \"../../mui-imports.js\";\nimport {MButton, getColor} from \"../../components/index.js\";\nimport Painter from \"./Painter.js\";\nimport AddEditSegmentDialog from \"./AddEditSegmentDialog.js\";\nimport SegmentMenu from \"./SegmentMenu.js\";\n\nexport default class PaintLabelsDialog extends Component {\n  static propTypes = {\n    fullScreen: PropTypes.bool,\n    open: PropTypes.bool,\n    datasetimage: PropTypes.object,\n    model: PropTypes.object,\n    segments: PropTypes.array,\n    onClose: PropTypes.func.isRequired,\n    addSegment: PropTypes.func.isRequired,\n    removeSegment: PropTypes.func.isRequired,\n    updateSegment: PropTypes.func.isRequired,\n  };\n\n  state = {\n    imgW: null,\n    imgH: null,\n    imgLoaded: false,\n    activeSegmentIdx: 1,\n    segmentCtrlsDisabled: false,\n    segmentAnchorEl: null,\n    selectedSegmentIdx: null,\n    brushMode: \"draw\",\n    addEditSegmentDialog: {\n      open: false,\n      saveText: \"\",\n      label: \"\",\n      rgb: [0, 0, 255],\n      onSave: null,\n      segmentIdx: null,\n    },\n  };\n\n  drawerWidth = 240;\n  topBarHeight = 64;\n\n  constructor(props) {\n    super(props);\n    this.imgRef = React.createRef();\n    this.canvasContainerRef = React.createRef();\n    this.brushColor = this.rgb2hex(this.props.segments[1].rgb);\n  }\n\n  handleClose = () => {\n    if (this.painter) {\n      this.props.datasetimage.label_image._segmentation_data = this.painter.getDataURL();\n    }\n    this.props.onClose();\n  };\n\n  initDrawing(canvas) {\n    if (!canvas || this.painter) return;\n\n    if (!this.props.datasetimage.label_image) this.props.datasetimage.label_image = {};\n    const existingSegmentationUrl =\n      this.props.datasetimage.label_image._segmentation_data ||\n      this.props.datasetimage.label_image.image;\n\n    this.painter = new Painter({\n      canvas,\n      container: this.canvasContainerRef.current,\n      dx: -3 - this.drawerWidth,\n      dy: -2 - this.topBarHeight,\n      url: existingSegmentationUrl,\n      setDirty: isDirty => (this.props.datasetimage._label_dirty = isDirty),\n      getBrushMode: () => this.state.brushMode,\n      getBrushColor: () => this.brushColor,\n    });\n  }\n\n  rgb2hex(rgbArr) {\n    return \"#\" + rgbArr.map(x => (\"0\" + x.toString(16)).slice(-2)).join(\"\");\n  }\n\n  removeSegment = idx => {\n    this.setState({segmentCtrlsDisabled: true});\n\n    // store rgbs needed to remove pixels\n    // (BEFORE removing segment and loosing this data)\n    const segmentRGBs = this.props.segments.map(sgm => sgm.rgb);\n    const removedSegmentRGB = segmentRGBs.splice(idx, 1)[0];\n\n    this.props.removeSegment(idx);\n\n    this.painter.removePixels(removedSegmentRGB, segmentRGBs);\n\n    if (this.props.segments.length >= 2) this.setActiveSegment(1);\n\n    this.setState({segmentCtrlsDisabled: false});\n  };\n\n  addSegment = async data => {\n    await this.props.addSegment(data);\n  };\n\n  updateSegment = async data => {\n    await this.props.updateSegment(data);\n  };\n\n  setActiveSegment = idx => {\n    this.brushColor = this.rgb2hex(this.props.segments[idx].rgb);\n    this.setState({activeSegmentIdx: idx});\n  };\n\n  render() {\n    const Sidebar = this.makeSidebar();\n\n    return (\n      <mui.Dialog open={this.props.open} onClose={this.handleClose} fullScreen>\n        <mui.AppBar position=\"fixed\" style={{zIndex: 12345}}>\n          <mui.Toolbar>\n            <div style={{flexGrow: 1}}>\n              {this.props.datasetimage.id} -{\" \"}\n              <strong>\n                {this.props.datasetimage.image.summary.thumb.split(\"/\").slice(-1)[0]}\n              </strong>\n              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n              <sui.Button.Group>\n                <sui.Button\n                  positive={this.state.brushMode === \"draw\"}\n                  onClick={() => this.setState({brushMode: \"draw\"})}\n                >\n                  Draw\n                </sui.Button>\n                <sui.Button.Or />\n                <sui.Button\n                  positive={this.state.brushMode === \"erase\"}\n                  onClick={() => this.setState({brushMode: \"erase\"})}\n                >\n                  Erase\n                </sui.Button>\n              </sui.Button.Group>\n            </div>\n            <mui.IconButton color=\"inherit\" onClick={this.handleClose} aria-label=\"Close\">\n              <mui.Icon>close</mui.Icon>\n            </mui.IconButton>\n          </mui.Toolbar>\n        </mui.AppBar>\n\n        <nav\n          style={{\n            width: this.drawerWidth,\n            flexShrink: 0,\n          }}\n        >\n          <mui.Drawer\n            style={{\n              width: this.drawerWidth,\n            }}\n            variant=\"permanent\"\n            open\n          >\n            <Sidebar />\n          </mui.Drawer>\n        </nav>\n\n        <div\n          style={{\n            position: \"fixed\",\n            top: 64,\n            left: this.drawerWidth,\n            width: `calc(100% - ${this.drawerWidth}px)`,\n            height: \"calc(100% - 64px)\",\n            overflow: \"scroll\",\n          }}\n          ref={this.canvasContainerRef}\n        >\n          <img\n            style={{\n              width: \"auto\",\n              height: \"auto\",\n              border: \"4px solid purple\",\n            }}\n            src={this.props.datasetimage.image.image}\n            alt=\"\"\n            onLoad={() =>\n              this.setState({\n                imgLoaded: true,\n                imgW: this.imgRef.current.naturalWidth,\n                imgH: this.imgRef.current.naturalHeight,\n              })\n            }\n            ref={this.imgRef}\n          />\n          {this.state.imgLoaded && (\n            <canvas\n              width={this.state.imgW}\n              height={this.state.imgH}\n              ref={el => this.initDrawing(el)}\n              style={{\n                position: \"absolute\",\n                top: 0,\n                left: 0,\n                opacity: 0.5,\n                border: \"4px solid transparent\",\n                cursor: \"crosshair\",\n              }}\n            />\n          )}\n        </div>\n        <AddEditSegmentDialog\n          {...this.state.addEditSegmentDialog}\n          onClose={() =>\n            this.setState(s => imm.set(s, \"addEditSegmentDialog.open\", false))\n          }\n          key={this.state.addEditSegmentDialog.segmentIdx}\n        />\n      </mui.Dialog>\n    );\n  }\n\n  makeSidebar() {\n    return mui.withStyles(theme => ({\n      toolbar: theme.mixins.toolbar,\n    }))(props => (\n      <div style={{width: this.drawerWidth}}>\n        <div className={props.classes.toolbar} />\n        <mui.Divider />\n        <mui.List>\n          {this.props.segments.slice(1).map((segment, idx) => (\n            <mui.ListItem\n              button\n              key={idx}\n              style={\n                idx + 1 === this.state.activeSegmentIdx\n                  ? {\n                      background: getColor(\":blue.100\")[0],\n                    }\n                  : {}\n              }\n              onClick={() => this.setActiveSegment(idx + 1)}\n            >\n              <mui.ListItemIcon\n                style={{marginRight: 0, color: this.rgb2hex(segment.rgb)}}\n              >\n                <mui.Icon>palette</mui.Icon>\n              </mui.ListItemIcon>\n              <mui.ListItemText style={{marginRight: 0}}>\n                {segment.label}\n              </mui.ListItemText>\n\n              <MButton\n                icon=\"more_vert\"\n                size=\"small\"\n                style={{\n                  marginRight: -20,\n                  minWidth: 32,\n                }}\n                onClick={event => {\n                  console.log(\"clicked segment opener:\", event.currentTarget);\n                  const anchorEl = event.currentTarget;\n                  const anchorElBox = anchorEl.getBoundingClientRect();\n                  this.setState({\n                    segmentAnchorEl: event.currentTarget,\n                    segmentMenuTop: anchorElBox.top,\n                    segmentMenuLeft: anchorElBox.left,\n                    selectedSegmentIdx: idx + 1,\n                  });\n                }}\n              />\n            </mui.ListItem>\n          ))}\n        </mui.List>\n        <mui.Divider />\n        <mui.List>\n          <mui.ListItem>\n            <mui.Fab\n              variant=\"extended\"\n              size=\"small\"\n              color=\"secondary\"\n              aria-label=\"Add\"\n              style={{marginLeft: 35}}\n              onClick={() =>\n                this.setState({\n                  addEditSegmentDialog: {\n                    dialogTitle: \"Add New Segment\",\n                    open: true,\n                    segmentIdx: this.props.segments.length,\n                    saveText: \"Add\",\n                    label: \"\",\n                    rgb: [0, 0, 255],\n                    onSave: data => {\n                      this.props.addSegment({label: data.label, rgb: data.rgb});\n                      this.setState(s => imm.set(s, \"addEditSegmentDialog.open\", false));\n                      setTimeout(\n                        // allow for props to be updated\n                        () => this.setActiveSegment(this.props.segments.length - 1),\n                        0\n                      );\n                    },\n                  },\n                })\n              }\n            >\n              <mui.Icon>add</mui.Icon>\n              Add segment &nbsp;\n            </mui.Fab>\n          </mui.ListItem>\n        </mui.List>\n        <SegmentMenu\n          anchorEl={this.state.segmentAnchorEl}\n          open={!!this.state.segmentAnchorEl}\n          onClose={() => this.setState({segmentAnchorEl: null})}\n          removeItem={this.removeSegment}\n          editItem={idx =>\n            this.setState({\n              addEditSegmentDialog: {\n                dialogTitle: \"Update Segment\",\n                open: true,\n                segmentIdx: idx,\n                saveText: \"Update\",\n                label: this.props.segments[idx].label,\n                rgb: this.props.segments[idx].rgb,\n                onSave: data => {\n                  this.props.updateSegment(idx, data);\n                  this.setState(s => imm.set(s, \"addEditSegmentDialog.open\", false));\n                },\n              },\n            })\n          }\n          selectedSegmentIdx={this.state.selectedSegmentIdx}\n          segmentMenuTop={this.state.segmentMenuTop}\n          segmentMenuLeft={this.state.segmentMenuLeft}\n        />\n      </div>\n    ));\n  }\n}\n","import React, {Component} from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport PaintLabelsDialog from \"./PaintLabelsDialog/PaintLabelsDialog.js\";\nimport {DatasetCard, ItemBtn} from \"./DatasetCard.js\";\n\nexport default class Step2Labels extends Component {\n  static propTypes = {\n    model: PropTypes.object,\n    trainingDatasets: PropTypes.arrayOf(Object).isRequired,\n    updateTrainingDataset: PropTypes.func.isRequired,\n    addSegment: PropTypes.func.isRequired,\n    removeSegment: PropTypes.func.isRequired,\n    updateSegment: PropTypes.func.isRequired,\n  };\n\n  state = {\n    paintLabelsDialog: {\n      open: false,\n      datasetImage: null,\n    },\n  };\n\n  render() {\n    if (!this.props.trainingDatasets.length) return null;\n\n    return (\n      <>\n        {this.props.trainingDatasets.map((dataset, datasetIdx) => (\n          <DatasetCard\n            key={`${dataset.id}-${datasetIdx}`}\n            dataset={dataset}\n            datasetIdx={datasetIdx}\n            updateTrainingDataset={data =>\n              this.props.updateTrainingDataset(datasetIdx, data)\n            }\n            imageActions={params => (\n              <ItemBtn\n                children=\"Add/Edit Segmentation Labels\"\n                variant=\"contained\"\n                icon=\"fa-paint-brush\"\n                color=\":pink\"\n                onClick={() =>\n                  this.setState({\n                    paintLabelsDialog: {\n                      open: true,\n                      datasetImage: params.datasetimage,\n                    },\n                  })\n                }\n              />\n            )}\n          />\n        ))}\n\n        {this.state.paintLabelsDialog.open &&\n          this.props.model &&\n          this.props.trainingDatasets[0] && (\n            <PaintLabelsDialog\n              fullScreen\n              open={this.state.paintLabelsDialog.open}\n              onClose={() =>\n                this.setState({\n                  paintLabelsDialog: {\n                    open: false,\n                    datasetImage: null,\n                  },\n                })\n              }\n              datasetimage={this.state.paintLabelsDialog.datasetImage}\n              model={this.props.model}\n              segments={this.props.model.labels}\n              addSegment={this.props.addSegment}\n              removeSegment={this.props.removeSegment}\n              updateSegment={this.props.updateSegment}\n            />\n          )}\n      </>\n    );\n  }\n}\n","import React, {Component} from \"react\";\n// import PropTypes from \"prop-types\";\nimport {Route, Switch} from \"react-router-dom\";\nimport queryString from \"query-string\";\nimport {default as imm} from \"object-path-immutable\";\nimport * as sui from \"semantic-ui-react\";\n\nimport * as mui from \"../mui-imports.js\";\nimport {augmentWithStateFieldArrayMethods} from \"../utils.js\";\nimport {Datasets, MLModels, Images, LabelImages, APIResponseError} from \"../api/api.js\";\nimport {MButton} from \"../components\";\nimport Step1Data from \"./Step1Data.js\";\nimport Step2Labels from \"./Step2Labels.js\";\nimport Step3Training from \"./Step3Training.js\";\n\nconst steps = [\n  {\n    key: \"data\",\n    icon: \"images\",\n    title: \"Data\",\n    description: \"Add/select training data\",\n    active: true,\n  },\n  {\n    key: \"labels\",\n    icon: \"paint brush\",\n    title: \"Labels\",\n    description: \"Label training data\",\n    // disabled: true,\n  },\n  {\n    key: \"training\",\n    icon: \"cogs\",\n    title: \"Training\",\n    description: \"Train model with labeled data\",\n  },\n];\n\nclass PageTrainModel extends Component {\n  static propTypes = {};\n\n  state = {\n    DATA: {\n      datasetsById: new Map(),\n      trainingDatasets: [],\n      model: null,\n    },\n    disableNav: false,\n  };\n\n  constructor(props) {\n    super(props);\n    augmentWithStateFieldArrayMethods(this, \"DATA.model.labels\", \"Segment\");\n    augmentWithStateFieldArrayMethods(this, \"DATA.trainingDatasets\", \"TrainingDataset\");\n  }\n\n  componentDidMount() {\n    MLModels.get(this.props.match.params.modelId).then(res => {\n      this.setState(s => imm.set(s, \"DATA.model\", MLModels.fromApiData(res.data)));\n    });\n\n    Datasets.list().then(res => {\n      const datasetsById = new Map(\n        res.data.results.map(ds => [ds.id, Datasets.fromApiData(ds)])\n      );\n      // const datasets = Array.from(datasetsById.values()); // DEBUG\n      this.setState(s =>\n        imm(s)\n          .set(\"DATA.datasetsById\", datasetsById)\n          // .set(\"DATA.trainingDatasets\", datasets.slice(0, 2)) // DEBUG\n          .value()\n      );\n    });\n  }\n\n  addTrainingDatasetImage = (datasetIdx, dsi) =>\n    this.setState(s =>\n      imm.push(s, `DATA.trainingDatasets.${datasetIdx}.datasetimages`, dsi)\n    );\n\n  removeTrainingDatasetImage = (datasetIdx, dsiIdx) =>\n    this.setState(s =>\n      imm.del(s, `DATA.trainingDatasets.${datasetIdx}.datasetimages.${dsiIdx}`)\n    );\n\n  replaceTrainingDatasetImage = (datasetIdx, dsiIdx, data) =>\n    this.setState(s =>\n      imm.set(s, `DATA.trainingDatasets.${datasetIdx}.datasetimages.${dsiIdx}`, data)\n    );\n\n  updateTrainingDatasetImage = (datasetIdx, dsiIdx, data) =>\n    this.setState(s =>\n      imm.merge(s, `DATA.trainingDatasets.${datasetIdx}.datasetimages.${dsiIdx}`, data)\n    );\n\n  navToStep = stepNo => {\n    const {match, location, history} = this.props;\n    history.push(\n      `${match.url}/step-${stepNo + 1}-${steps[stepNo].key}${location.search}`\n    );\n  };\n\n  navToNextStep = async () => {\n    const activeStepNo = this.getActiveStepNo(this.props.location.pathname);\n    const activeStep = steps[activeStepNo].key;\n\n    this.setState({disableNav: true});\n\n    try {\n      if (activeStep === \"data\") await this.onNextFromStep1Data();\n      else if (activeStep === \"labels\") await this.onNextFromStep2Labels();\n\n      this.navToStep(activeStepNo + 1);\n    } catch (e) {\n      // TODO: display error to user\n      console.log(\"Dataset creation or image upload error:\", e);\n    } finally {\n      this.setState({disableNav: false});\n    }\n  };\n\n  onNextFromStep1Data = async () => this.createNewDatasets();\n\n  onNextFromStep2Labels = async () => {\n    await this.updateModel();\n    await this.saveLabels();\n  };\n\n  markActiveStep = (steps, activeStep) => {\n    return steps.map((step, idx) => ({\n      ...step,\n      active: idx === activeStep,\n    }));\n  };\n\n  getActiveStepNo(path) {\n    const m = path.match(/\\/train\\/step-(\\d+)/);\n    if (!m) return -1;\n    return m[1] - 1;\n  }\n\n  createNewDatasets = async () => {\n    for (\n      let datasetIdx = 0;\n      datasetIdx < this.state.DATA.trainingDatasets.length;\n      datasetIdx++\n    ) {\n      const dataset = this.state.DATA.trainingDatasets[datasetIdx];\n\n      if (dataset.id) continue;\n\n      const createdDatasetImages = [];\n\n      for (let dsiIdx = 0; dsiIdx < dataset.datasetimages.length; dsiIdx++) {\n        const dsi = dataset.datasetimages[dsiIdx];\n\n        if (dsi.image_id) {\n          createdDatasetImages.push(dsi);\n          continue;\n        }\n\n        this.updateTrainingDatasetImage(datasetIdx, dsiIdx, {_status: \"uploading\"});\n\n        try {\n          const createImageRes = await this.createImage(dsi, dsiIdx);\n\n          const createdDatasetImage = {\n            image_id: createImageRes.data.id,\n            image: createImageRes.data,\n            purpose: \"validation\",\n            _status: \"uploaded\",\n          };\n          createdDatasetImages.push(createdDatasetImage);\n          this.updateTrainingDatasetImage(datasetIdx, dsiIdx, createdDatasetImage);\n          //\n        } catch (e) {\n          this.updateTrainingDatasetImage(datasetIdx, dsiIdx, {\n            _status: \"upload failed\",\n            _error: e,\n          });\n        }\n      }\n\n      if (createdDatasetImages.length !== dataset.datasetimages.length) {\n        throw Error(\"Some images could not be uploaded\");\n      }\n\n      const createdDatasetRes = await Datasets.create({\n        name: dataset.name,\n        datasetimages: createdDatasetImages.map(it => ({\n          image_id: it.image_id,\n          purpose: it.purpose,\n        })),\n      });\n      if (Math.floor(createdDatasetRes.status / 100) === 2) {\n        this.updateTrainingDataset(datasetIdx, {\n          ...createdDatasetRes.data,\n          datasetimages: createdDatasetImages,\n        });\n      }\n    }\n  };\n\n  createImage = async (dsi, dsiIdx) => {\n    const file = dsi._fileInput.current.files[0];\n    const match = file.name.match(/(.+)\\.[^.]+$/);\n    const name = dsiIdx + \"-\" + (match ? match[1] : file.name);\n    return Images.create({name, image: {file}});\n  };\n\n  updateModel = () => MLModels.update(this.state.DATA.model);\n\n  saveLabels = async () => {\n    for (\n      let datasetIdx = 0;\n      datasetIdx < this.state.DATA.trainingDatasets.length;\n      datasetIdx++\n    ) {\n      const dataset = this.state.DATA.trainingDatasets[datasetIdx];\n\n      for (let dsiIdx = 0; dsiIdx < dataset.datasetimages.length; dsiIdx++) {\n        const dsi = dataset.datasetimages[dsiIdx];\n\n        if (!dsi._label_dirty) continue;\n\n        if (!dsi.label_image) {\n          throw Error(`Error: image ${dsiIdx} of dataset \"${dsi.name}\" is not labeled`);\n        }\n\n        try {\n          const res = await this.updateOrCreateLabelImage(dsi);\n\n          if (Math.floor(res.status / 100) !== 2) {\n            throw APIResponseError(res);\n          }\n\n          this.updateTrainingDatasetImage(datasetIdx, dsiIdx, {\n            label_image_id: res.data.id,\n            _label_save_status: \"success\",\n            _label_dirty: false,\n          });\n          dsi.label_image.id = res.data.id;\n        } catch (e) {\n          console.error(\"Error saving label:\", e);\n\n          this.updateTrainingDatasetImage(datasetIdx, dsiIdx, {\n            _label_save_status: \"failed\",\n            _label_save_error: e,\n          });\n        }\n      }\n    }\n  };\n\n  updateOrCreateLabelImage = dsi => {\n    const base64ImgData = dsi.label_image._segmentation_data;\n    if (dsi.label_image.id) {\n      return LabelImages.update({\n        id: dsi.label_image.id,\n        image: {file_contents: base64ImgData},\n        dataset_image_id: dsi.id,\n      });\n    } else {\n      return LabelImages.create({\n        image: {file_contents: base64ImgData},\n        models: [this.props.match.params.modelId],\n        dataset_image_id: dsi.id,\n      });\n    }\n  };\n\n  render() {\n    const {match, location} = this.props;\n    const archId = +queryString.parse(location.search).arch || null;\n    const activeStep = this.getActiveStepNo(location.pathname);\n\n    return (\n      <div className=\"ModelTraining\">\n        <mui.Grid container>\n          <mui.Grid item xs={8}>\n            Based on arcitecture <code>{archId}</code>.\n          </mui.Grid>\n          <mui.Grid item xs={4}>\n            <mui.Typography align=\"right\">\n              <PrevBtn\n                onClick={() => this.navToStep(activeStep - 1)}\n                disabled={this.state.disableNav || activeStep <= 0}\n              />\n              &nbsp;&nbsp;&nbsp;\n              <NextBtn\n                onClick={this.navToNextStep}\n                disabled={this.state.disableNav || activeStep === steps.length - 1}\n              />\n            </mui.Typography>\n          </mui.Grid>\n        </mui.Grid>\n\n        <sui.Step.Group\n          items={this.markActiveStep(steps, activeStep)}\n          style={{width: \"100%\", borderRadius: 0}}\n        />\n        <br />\n        <br />\n\n        <Switch>\n          <Route\n            exact\n            path={match.path + \"/step-1-data\"}\n            render={props => (\n              <Step1Data\n                {...{\n                  ...props,\n                  ...{\n                    model: this.state.DATA.model,\n                    datasetsById: this.state.DATA.datasetsById,\n                    trainingDatasets: this.state.DATA.trainingDatasets,\n                    addTrainingDataset: this.addTrainingDataset,\n                    removeTrainingDataset: this.removeTrainingDataset,\n                    updateTrainingDataset: this.updateTrainingDataset,\n                    addTrainingDatasetImage: this.addTrainingDatasetImage,\n                    removeTrainingDatasetImage: this.removeTrainingDatasetImage,\n                  },\n                }}\n              />\n            )}\n          />\n          <Route\n            exact\n            path={match.path + \"/step-2-labels\"}\n            render={props => (\n              <Step2Labels\n                {...{\n                  ...props,\n                  ...{\n                    model: this.state.DATA.model,\n                    trainingDatasets: this.state.DATA.trainingDatasets,\n                    updateTrainingDataset: this.updateTrainingDataset,\n                    addSegment: this.addSegment,\n                    removeSegment: this.removeSegment,\n                    updateSegment: this.updateSegment,\n                  },\n                }}\n              />\n            )}\n          />\n          <Route\n            exact\n            path={match.path + \"/step-3-training\"}\n            render={props => (\n              <Step3Training\n                {...{\n                  ...props,\n                  ...{\n                    model: this.state.DATA.model,\n                    trainingDatasets: this.state.DATA.trainingDatasets,\n                  },\n                }}\n              />\n            )}\n          />\n        </Switch>\n\n        <br />\n        <mui.Grid container spacing={16}>\n          <mui.Grid item xs={6}>\n            <PrevBtn\n              onClick={() => this.navToStep(activeStep - 1)}\n              disabled={this.state.disableNav || activeStep <= 0}\n              fullWidth\n              size=\"large\"\n            />\n          </mui.Grid>\n          <mui.Grid item xs={6}>\n            <NextBtn\n              onClick={this.navToNextStep}\n              disabled={this.state.disableNav || activeStep === steps.length - 1}\n              fullWidth\n              size=\"large\"\n            />\n          </mui.Grid>\n        </mui.Grid>\n      </div>\n    );\n  }\n}\n\nexport default PageTrainModel;\n\nconst NextBtn = props =>\n  MButton({\n    color: \"primary\",\n    size: \"small\",\n    variant: \"contained\",\n    icon: \"chevron_right\",\n    iconRight: true,\n    children: \"Next\",\n    ...props,\n  });\n\nconst PrevBtn = props =>\n  MButton({\n    size: \"small\",\n    icon: \"chevron_left\",\n    children: \"Previous\",\n    ...props,\n  });\n","import React, {Component} from \"react\";\n// import PropTypes from \"prop-types\";\n\nimport {MButton, MPaper} from \"../components\";\nimport {MLModels} from \"../api/api.js\";\n\nclass PageCreateModel extends Component {\n  static propTypes = {};\n\n  createModelThenTrain = async data => {\n    const res = await MLModels.create(data);\n    this.props.setLastCreatedModel(res.data);\n    this.props.history.push(`/models/${res.data.id}/train`);\n  };\n\n  render() {\n    return (\n      <div className=\"Page\">\n        <MPaper>\n          <pre>[ create model ]</pre>\n          <MButton\n            linkTo=\"/models/1/train/step-1-data\"\n            variant=\"contained\"\n            color=\"primary\"\n          >\n            Create & train\n          </MButton>\n        </MPaper>\n      </div>\n    );\n  }\n}\n\nexport default PageCreateModel;\n","import React, {Component} from \"react\";\n// import PropTypes from \"prop-types\";\nimport {Route, Switch} from \"react-router-dom\";\nimport {default as imm} from \"object-path-immutable\";\n\nimport * as mui from \"./mui-imports.js\";\nimport PageDashboard from \"./PageDashboard/PageDashboard.js\";\nimport PageModels from \"./PageModels/PageModels.js\";\nimport PageAnalyses from \"./PageAnalyses/PageAnalyses.js\";\nimport PageTrainModel from \"./PageTrainModel/PageTrainModel.js\";\nimport PageCreateModel from \"./PageCreateModel/PageCreateModel.js\";\nimport \"./App.scss\";\nimport {Users} from \"./api/api.js\";\n\nconst styles = theme => ({\n  root: {\n    flexGrow: 1,\n    backgroundColor: theme.palette.background.paper,\n  },\n  paper: {\n    padding: theme.spacing.unit * 2,\n  },\n  grow: {\n    flexGrow: 1,\n  },\n});\n\nclass App extends Component {\n  static propTypes = {};\n\n  state = {\n    DATA: {\n      user: null,\n      lastCreatedModel: null,\n    },\n  };\n\n  componentDidMount() {\n    Users.getSelf().then(res => this.setState({DATA: {user: res.data}}));\n  }\n\n  setLastCreatedModel = modelData => imm.set(this.state, \"DATA.modelData\", modelData);\n\n  render() {\n    const {classes} = this.props;\n\n    if (!this.state.DATA.user) return <p>Loading...</p>;\n\n    return (\n      <>\n        <mui.CssBaseline />\n        <div className=\"App\">\n          <mui.AppBar position=\"static\">\n            <mui.Toolbar>\n              <mui.Typography variant=\"h6\" color=\"inherit\" className={classes.grow}>\n                HBot\n              </mui.Typography>\n              <mui.Button color=\"inherit\">Logout</mui.Button>\n            </mui.Toolbar>\n          </mui.AppBar>\n\n          <div className=\"App-container\">\n            <div>\n              <Route\n                children={({match, history, location}) => (\n                  <mui.Tabs\n                    value={\"/\" + location.pathname.split(\"/\")[1]}\n                    onChange={(ev, path) => history.push(path)}\n                  >\n                    <mui.Tab value=\"/\" label=\"Dashboard\" />\n                    <mui.Tab value=\"/models\" label=\"Models\" />\n                    <mui.Tab value=\"/analyses\" label=\"Analyses\" />\n                  </mui.Tabs>\n                )}\n              />\n              <br />\n\n              <Switch>\n                <Route exact path=\"/\" component={PageDashboard} />\n                <Route exact path=\"/models\" component={PageModels} />\n                <Route\n                  path=\"/models/new\"\n                  render={props => (\n                    <PageCreateModel\n                      {...{\n                        ...props,\n                        setLastCreatedModel: this.setLastCreatedModel,\n                      }}\n                    />\n                  )}\n                />\n                <Route path=\"/models/:modelId/train\" component={PageTrainModel} />\n                <Route exact path=\"/analyses\" component={PageAnalyses} />\n              </Switch>\n            </div>\n          </div>\n\n          {/*<br />*/}\n          {/*<pre>FOOZ: {process.env.REACT_APP_FOOZ}</pre>*/}\n\n          {/*<br />*/}\n          {/*<Route*/}\n          {/*  children={props => {*/}\n          {/*    window._h = props.history;*/}\n          {/*    return <pre>{JSON.stringify(props, null, 2)}</pre>;*/}\n          {/*  }}*/}\n          {/*/>*/}\n        </div>\n      </>\n    );\n  }\n}\n\nexport default mui.withStyles(styles)(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport {BrowserRouter as Router} from \"react-router-dom\";\nimport {_} from \"underscore\";\n\nimport * as _utils_ from \"./utils.js\";\nimport \"./styles/index.scss\";\n\nimport \"semantic-ui-css/semantic.min.css\";\n\n// DEBUG/DEV helpers\nwindow._ = _;\nwindow._utils_ = _utils_;\n\nReactDOM.render(\n  <Router>\n    <App />\n  </Router>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}